---
title: "Assignment 1"
subtitle: "Data set selection and initial Processing"
author: "Anna T. Lai"
date: "`February 13, 2024`"
output:
  html_document:
    toc: true
    toc_depth: 2
bibliography: assignment_reference.bib
csl: biomed-central.csl
---

## Setup

```{r setup, results='hide'}
packages_to_install <- c("BiocManager", "RSQLite", "readr")
for (package in packages_to_install) {
  if (!requireNamespace(package, quietly = TRUE)) {
    install.packages(package)
  }
  library(package, character.only = TRUE)
}

library(BiocManager)
library(GEOmetadb)
library(RSQLite)
library(readr)
library(utils)
library(base)
library(dplyr)
```


## Data Selection

Please refer to the GitHub Wiki Journal [Data Selection](https://github.com/bcb420-2024/Anna_Lai/wiki/Data-Selection). 

The Data can be found here: [	Transcriptional profiling of organoid glomeruli isolated from human kidney organoids modelling congenital nephrotic syndrome](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE205647). There are two files, the gene names and the gene counts.

```{r warning=FALSE}
files <- c("GSE205647_counts.txt", "GSE205647_genes.txt")

counts_data <- read.table(files[1], header = TRUE)
head(counts_data)

genes_data <- read.table(files[2], header = TRUE)
head(genes_data)


print(nrow(counts_data))
print(nrow(genes_data))

# print duplicate count by Gene.ID
duplicates_count <- counts_data %>% 
  group_by(Gene.ID) %>% 
  mutate(duplicate_count = n()) %>% 
  filter(duplicate_count > 1)

print(nrow(duplicates_count))

# print duplicate count by Gene.Name
duplicates_count <- genes_data %>% 
  group_by(Gene.Name, Chrom) %>% 
  mutate(duplicate_count = n()) %>% 
  filter(duplicate_count > 1) %>% 
  summarize(duplicate_count = n_distinct(Gene.ID))

duplicates_count
```
The number of duplicated genes:
```{r}
print(nrow(duplicates_count))
head(duplicates_count)
```



As the file genes contain the same first four column as the counts file, we will proceed with the counts file only. 

## Data cleaning and HUGO mapping

## Data Normalization

## Citations (if any)

* [Cytoscape](www.cytoscape.org)[@cytoscape2003] is a
freely available open-source, cross platform network
analysis software.

https://bioconductor.org/packages/release/bioc/html/GEOmetadb.html